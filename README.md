# Basic Formatting Utilities

## Overview

This is a simple set of utilities to format a JavaScript object into an HTML table.

If the table contains nested objects, arrays or maps, these will be displayed in a collapsed form.  Click on the expand/collapse icons in the `Type` column to hide or display this data.

I wrote this utility primarily to overcome the problem that many standard objects (such as HTTP `request` or `response` objects) contains circular references that cause `JSON.stringify` to explode.

Therefore, the `create_content` function listed below creates an HTML table representation of an object containing nested objects, but only down to some predetermined recursion depth.  The default recursion depth is 2, but this can be adjusted by passing a positive integer to `set_depth_limit()`


##Â Usage

Let's say that for the purposes of debugging, you want to display the contents of some server-side objects in the browser.  In this example, your NodeJS app receives an HTTP request.  Your event handler function is passed `event` and `context` objects and in addition to these, you also want to see inside NodeJS's `process` object.

Your code would look something like this:

```javascript
var utils = require('basic-formatting-utils')
    
var format_response = (evt, ctx) =>
  utils.as_html([],
    utils.as_body([],
      utils.create_content([
        {title: "Context Variables", value: ctx}
      , {title: "Event Variables",   value: evt}
      , {title: "NodeJS process",    value: process}
      ])
    )
  )

// *********************************************************************************************************************
// PUBLIC API
// *********************************************************************************************************************
module.exports = {
 handler: (event, context) => format_response(event, context)
}
```

The extra coding shown above that packages the response from the call to `create_content` into HTML `body` and `html` elements is optional.

Typically, this utility will supply its HTML simply as a fragment of the overall Web page generated by some larger app.

## API

### Low-level Utilities

| Name | Return Type | Description
|---|---|---|
| `typeOf` | `String` | Returns the actual data type of the object as a string
| `isNull` | `Boolean` | Does exactly what it says on the tin...
| `isUndefined` | `Boolean` | Does exactly what it says on the tin...
| `isNullOrUndef` | `Boolean` | Does exactly what it says on the tin...
| `isNumeric` | `Boolean` | Does exactly what it says on the tin...
| `isArray` | `Boolean` | Does exactly what it says on the tin...
| `isMap` | `Boolean` | Does exactly what it says on the tin...
| `push` | The modified array | A wrapper for `Array.prototype.push` that pushes a new element onto the end of an array then returns the modified array rather than the much less useful index of the newly added element<br>This version of `push` can now be used during chained `reduce` operations.
| `unshift` | The modified array | A wrapper for `Array.prototype.unshift` that appends the new element at index `0` and returns the modified array rather than the length of the new array.<br>This version of `unshift` can now be used during chained `reduce` operations.
| `node_list_to_array` | `Array` | Converts JavaScript's array-like `NodeList` object into a standard `Array` that can be mapped over
| `timestamp_to_str` | `String` | Formats a timestamp into a more human-readable form

### HTML Utilities

| Name | Return Type | Description
|---|---|---|
| `as_html_el` | `Function` | This partial function accepts the tag name (E.G. `p` or `table` or `img` etc) and returns a function requiring two arguments:<ol><li>An array of the element's property values.  Pass an empty array if the element has no defined properties</li><li>The element's content in a form that is either a string, or where calling that object's `toString()` function returns something useful</li></ol>Any content passed to an empty HTML element (such as `img`) will be ignored
| `as_<tagName>` | `String` | Returns the respective HTML element string.<br>You must pass this function the following two arguments<ol><li>An array of strings, where each element is an HTML element property</li><li>The HTML element contents.<br>For empty elements such as `img`, any value passed in this parameter will be ignored</li></ol>E.G. To create a `<table>` element where the `border` is defined and all the table rows have been built up in some `acc`umulator array, the call would be something like:<pre>as_table(["border=\\"1\\""], acc.join(""))</pre> 
| `get_depth_limit` | `Number` | Returns the current recursion depth limit use when displaying nested objects
| `set_depth_limit` | `Number` | Sets the new recursion depth limit use when displaying nested objects.  
| `create_content` | `String` | Takes a single argument of an array of objects, where each object contains the following two properties<ol><li>`title` - Whatever header text you want describe the object</li><li>`value` - The object to be displayed</li></ol>Returns a `DIV` element containing the following children:<ol><li>A small style sheet</li><li>One or more `DIV` elements for each object it receives where each `DIV` contains a heading followed by a table representation of the object</li><li>A small block of JavaScript code to populate each arrow image's `src` property</li></ol>
